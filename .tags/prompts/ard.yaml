parameters:
  temperature: null
  topP: null
  topK: null
  frequencyPenalty: null
  presencePenalty: null
  maxOutputTokens: null
  stopSequences: null

defaults:
  adr-communication: "file://docs/adr-v3.1-rfc.md#adr"
  business-requirements: "file://docs/ARD-v3.1-rfc.md#business-requirements"
  container-diagram-communication: "file://docs/ARD-v3.1-rfc.md#container-diagram-communication"
  container-diagram-relationships: "file://docs/ARD-v3.1-rfc.md#container-diagram-relationships"
  data-sources: "file://docs/ARD-v3.1-rfc.md#data-sources"
  deployable-units: "file://docs/ARD-v3.1-rfc.md#functional-units"
  external-entities: "file://docs/ARD-v3.1-rfc.md#external-entities"
  max-short-problem-description-words: 50
  out-of-scope: "file://docs/ARD-v3.1-rfc.md#out-of-scope"
  personas: "file://docs/ARD-v3.1-rfc.md#personas"
  use-case: "file://docs/ARD-v3.1-rfc.md#use-case-???"
  use-cases: "file://docs/ARD-v3.1-rfc.md#use-cases"

system: |
  You are a helpful and precise AI assistant.
  Provide clear, accurate, and direct responses to the user's instructions.
  
  When generating Mermaid diagrams:
  - use consistent and reliable Unicode (Emoji) characters.
  - use actor icon for human participants
  - use proper stereotypes
  - add legend to diagrams

prompts:
  - id: "_01_ShortProblemDescription"
    template: |
      Given the following business requirements:
      {{business-requirements}}
      
      Your task is to create a "short problem description" that can be used as a subtitle 
      using at most {{max-short-problem-description-words}} words.
    gateway: "#tags+"
    plus: null

  - id: "_02_PersonaIdentification"
    template: |
      Given the following business requirements:
      {{business-requirements}}
      
      Your task is to identify all personas (types of human users or roles) the described system could interact with.
      
      Present first a minimal set of personas the system should support - make sure 
      that each requirement is linked to at least one persona in this case.
      
      Also propose an exhaustive list of personas that the system could support.
      
      Response formatting:
      - list personas as a markdown numbered list
      - persona names should be rendered in bold and after that add a column and a brief intuitive explanation of that persona (max 10 words)
      - explain in a sublist why that persona is required linking each explanation to the corresponding requirement

      
      An example persona rendering output:
      
      1. **Role**: brief role description
        - R3: Role needs to exist because ...

    gateway: "#tags+"

  - id: "_03_UseCaseGenerator"
    template: |
      Given the following business requirements
      ```business-requirements
      {{business-requirements}}
      ```
      
      and the following personas
      ```personas
      {{personas}}
      ```
      
      Your task is to generate the most relevant use cases for each persona.
      
      Constraints:
      - make sure that all business requirements are covered
      - structure each use case using the following pattern: As a <type of user>, I want <some goal>, so that <some reason/benefit>.

    gateway: "#tags+"
    plus: null

  - id: "_04_DataSources"
    template: |
      Given the following business requirements
      ```business-requirements:
      {{business-requirements}}
      ```
      
      and the following personas:
      ```personas
      {{personas}}
      ```
      
      and the following use cases:
      ```use-cases
      {{use-cases}}
      ```
      
      These topics are out of scope:
      ```out-of-scope
      {{out-of-scope}}
      ```
      
      Your task is to identify all data sources (business level) .
      For each type of data identify its legal owner and special handling requirements (GDPR, HIPAA, PCI-DSS, etc)

      Constraints:
      - render your response as a bulleted list with in-line explanations

  - id: "_05_SystemBoundaryIdentification"
    template: |
      Given the following business requirements
      ```business-requirements
      {{business-requirements}}
      ```
      
      and the following personas
      ```personas
      {{personas}}
      ```
      
      and the following use cases
      ```use-cases
      {{use-cases}}
      ```
      
      Your task is to exhaustively identify all the separate external entities the system will have to interact to.
      Consider mainly the external entities that should be present in a Context Diagram (C4 model).

    gateway: "#tags+"
    plus: null

  - id: "_06_C4_ContextDiagram"
    template: |
      Given the following business requirements
      ```business-requirements
      {{business-requirements}}
      ```

      and the following use cases
      ```use-cases
      {{use-cases}}
      ```
      
      and the following external entities
      ```external-entities
      {{external-entities}}
      ```

      Your task is to generate a Context Diagram (C4 model) using Mermaid.
      
      Constraints:
      - human actors are **external** to the system
      - you can use different visual markers / icons for human and non human entities
      - only render the diagram with nice arrows and labels but without textual explanations

    gateway: "#tags+"
    plus: null

  - id: "_07_IdentifyDeployableUnits"
    template: |
      Given the following business requirements
      ```business-requirements
      {{business-requirements}}
      ```

      and the following use cases
      ```use-cases
      {{use-cases}}
      ```

      and the following external entities
      ```external-entities
      {{external-entities}}
      ```

      Your task is to identify the deployment units as required in a Container Diagram (C4 model).

      Suggestions:
      - when creating the deployable units refrain from specifying a certain technology - keep it generic

    gateway: "chat"
    plus: null

  - id: "_08_C4_ContainerDiagram"
    template: |
      Given the following business requirements
      ```business-requirements
      {{business-requirements}}
      ```

      and the following use cases
      ```use-cases
      {{use-cases}}
      ```

      and the following external entities
      ```external-entities
      {{external-entities}}
      ```
      
      and the following deployable units
      ```deployable-units
      {{deployable-units}}
      ```

      Your task is to generate a Container Diagram (C4 model) using Mermaid.

      Suggestions:
      - make sure that all external-entities and all deployable-units appear in the diagram in clear and sensible relations
      - always add clear action labels to the arrows 
      - try to group external entities into logical clusters based on the deployable units they are communicating with

    gateway: "chat"
    plus: null

  - id: "_09_UseCaseSequenceDiagram"
    template: |
      Given the following business requirements
      ```business-requirements
      {{business-requirements}}
      ```
      
      and the following personas
      ```personas
      {{personas}}
      ```

      and the following external system entities
      ```external-entities
      {{external-entities}}
      ```
      
      and the following deployable units
      ```deployable-units
      {{deployable-units}}
      ```

      Your task is to generate a Sequence Diagram using Mermaid for the following use case:
      ```use-case
      {{use-case}}
      ```

    gateway: "chat"
    plus: null

  - id: "_10_EventStorming"
    template: |
      Given the following business requirements:
      ```business-requirements
      {{business-requirements}}
      ```
      
      and the following personas:
      ```personas
      {{personas}}
      ```

      and the following use cases:
      ```use-cases
      {{use-cases}}
      ```

      and the following data sources:
      ```data sources
      {{data-sources}}
      ```
      
      Your task is to simulate an Event Storming session (as suggested for filling an Architecture Response Document).
      
      Important:
      - this is a brainstorming session don't censor yourself too much
      - suggest as many commands, events, entities as your context window allows (within reason)
      - attempt to assign each command / event / entity to a domain
      - fell also free to use the same word with different meanings if it could be assigned to multiple domains
      - provide a brief explanation (up to 10 words) for each command / event / entity
      - do differentiate between each type of command / event / entity
      - format them as a domain list and for each domain group commands, events, and entities
      - use English language for output

  - id: "_11_UpdateContainerDiagram"
    template: |
      You will be given an ADR describing the communication between the containers of a system and a container diagram (C4 model)

      Your task will be to generate a new Mermaid diagram that renders the communication between services in a complete but very clear way.
      Please retain the diagram style, layout, positioning.
      Adjust the arrows according to the uni/bi directionality.

      So here is the ADR

      ```ADR
      {{adr-communication}}
      ```

      and here is the diagram to be updated

      {{container-diagram-relationships}}

  - id: "_12_UpdateSequenceDiagram"
    template: |
      You will be given a context describing the communication between the containers of a system and your task will be to upgrade a Mermaid sequence diagram.

      First you are required to understand the purpose of the system, the nodes (containers) of the diagram, and the edged (communication particularities):
      
      {{business-requirements}}

      {{adr-communication}}
      
      {{container-diagram-relationships}}

      **Given the understanding that you accumulated your task is now to update the sequence diagram 
      associated with the following use case into reflecting the communication patterns and updated nodes**
      
      {{use-case}}
      
      **Hints**:
      - use autonumber to clearly express the order of the actions
      - where applicable indicate the lifespan of the objects (activate/deactivate)

